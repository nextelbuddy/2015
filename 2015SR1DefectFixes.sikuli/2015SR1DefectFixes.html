
<html>
   <head>
      <style type="text/css">
         .sikuli-code {
            font-size: 20px;
            font-family: "Osaka-mono", Monospace;
            line-height: 1.5em;
            display:table-cell;
            white-space: pre-wrap;       /* css-3 */
            white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
            width: 99%;   /* remove horizontal scroll-bar when viewing in IE7 */
         }
         .sikuli-code img {
            vertical-align: middle;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 2px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -moz-box-shadow: 1px 1px 1px gray;
            -webkit-box-shadow: 1px 1px 2px gray;
         }
         .kw {
            color: blue;
         }
         .skw {
            color: rgb(63, 127, 127);
         }

         .str {
            color: rgb(128, 0, 0);
         }

         .dig {
            color: rgb(128, 64, 0);
         }

         .cmt {
            color: rgb(200, 0, 200);
         }

         h2 {
            display: inline;
            font-weight: normal;
         }

         .info {
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 20px;
            display: none;
         }

         a {
            color: #9D2900;
         }

         body {
            font-family: "Trebuchet MS", Arial, Sans-Serif;
         }

      </style>
   </head>
<body>
<div class="info">
<h2>2015SR1DefectFixes.sikuli\2015SR1DefectFixes.sikuli</h2> <a href="2015SR1DefectFixes.sikuli\2015SR1DefectFixes.zip">(Download this script)</a>
</div>
<pre class="sikuli-code">
<span class="kw">from</span> sikuli <span class="kw">import</span>*

<span class="kw">import</span> TABFunction
<span class="kw">import</span> os
<span class="kw">import</span> logging
<span class="kw">import</span> subprocess
<span class="kw">import</span> datetime
<span class="kw">import</span> Toolbox
startTime = datetime.datetime.now()





<span class="cmt">#Variables used in create client function    
</span>vClient_name_1 = <span class="str">'splitclient15'</span>
vClient_name_2 = <span class="str">'splitclient16'</span>
<span class="cmt">#Variables used in restore and backup functions
</span>vBDBLocation = os.path.join(<span class="str">r'C:\tssmoketest'</span>, <span class="str">'Backups'</span>, <span class="str">'Smoketest_Reprint_PDF_Test_backup.bku'</span>)
vRDBLocation = os.path.join(<span class="str">r'C:\Sikuli Scripts VM X local copy for testing'</span>, <span class="str">'2015'</span>, <span class="str">'Data'</span>, <span class="str">'Reprint Bill incorrect PDF.bku'</span>)

<span class="cmt">#These parameters are for the slip creation function where we can pass in values to the slip create method. 
</span>pTK = <span class="str">'sikuli timekeeper'</span>
pAct = <span class="str">'sikuli task'</span>
pClient = <span class="str">'sikuli client'</span>
pRef = <span class="str">'none'</span>
pExtra = <span class="str">'extra'</span>
pDescription = <span class="str">'Slip Description should be visible'</span>
pStartDate = <span class="str">'t'</span>
pEndDate = <span class="str">'t'</span>
pTimeEst = <span class="str">'1:00:00'</span>
pTimeSpent = <span class="str">'1:00:00'</span>
pRateValue = <span class="str">'150'</span>





<span class="kw">def</span> SR1_2015_defect_fixes():

    <span class="cmt">#Starting from Timeslips home screen
</span>    <span class="cmt">#Defect for Printing collated split bills
</span>    Toolbox.create_test_client(vClient_name_1)
    Toolbox.create_test_client(vClient_name_2)
    <span class="skw">type</span>(<span class="str">'b'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408371404528.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<img src="1408371471875.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(vClient_name_1)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'SR1 Test'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408373236033.png" />)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">7</span>):
        TABFunction.tab(x)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408373493377.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(vClient_name_2)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'SR1 test'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'50'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'50'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408373690690.png" />)
    <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    waitVanish(<img src="1408373728324.png" />)
    <span class="skw">type</span>(<span class="str">'m'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408378294656.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408378320890.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(vClient_name_1)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">7</span>):
        TABFunction.tab(x)
    paste(<span class="str">"1:00:00"</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">7</span>):
        TABFunction.tab(x)
    paste(<span class="str">'1000'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(Key.F4, KeyModifier.CTRL)
    waitVanish(<img src="1408382776753.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(<span class="str">'b'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408384417093.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'cli'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(Key.SPACE)
    <span class="skw">wait</span>(<img src="1408384512033.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(vClient_name_1)
    <span class="skw">type</span>(Key.F4)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408384512033.png" />)

    keyDown(Key.SHIFT)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">3</span>):
        TABFunction.tab(x)
    keyUp(Key.SHIFT)
    <span class="skw">type</span>(<span class="str">'printer...'</span>)
    <span class="skw">type</span>(<span class="str">'p'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408384822716.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'microsoft'</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">3</span>):
        TABFunction.tab(x)
    paste(<span class="str">'5'</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(<img src="1408385345350.png" />):
        <span class="skw">type</span>(<span class="str">'o'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(Key.ENTER)
    <span class="kw">if</span> exists(Pattern(<img src="1408385450858.png" />).similar(<span class="dig">0.87</span>)):
        <span class="skw">click</span>(Pattern(<img src="1408385450858.png" />).similar(<span class="dig">0.87</span>))
    <span class="skw">wait</span>(<img src="1408385485763.png" />, <span class="dig">30</span>)
    paste(<span class="str">'SR1 Defect Collate test'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.ALT)
    <span class="kw">if</span> exists(<img src="1408386107497.png" />):
        <span class="skw">type</span>(<span class="str">'y'</span>, KeyModifier.ALT)
    waitVanish(<img src="1408385485763.png" />)
    <span class="skw">click</span>(<img src="1408385625824.png" />)
    <span class="skw">type</span>(Key.ENTER)
    onAppear(<img src="1408385861684.png" />, <span class="skw">type</span>(Key.ENTER))
    waitVanish(<img src="1408385861684.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="kw">if</span> exists(<img src="1408385931427.png" />):
        <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="cmt">#----------------------------------------------------------------------#
</span>
    <span class="cmt">#Starting from Timeslips home screen
</span>    <span class="cmt">#Defect for Date displaying 1899 in calendar entry and timecapture toolbits. 
</span>    <span class="skw">type</span>(<span class="str">'l'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'n'</span>)
    <span class="skw">wait</span>(<img src="1408387917993.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB + Key.TAB)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">wait</span>(<img src="1408387963478.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408387963478.png" />)
    <span class="kw">assert</span> <span class="kw">not</span> exists(<img src="1408388009755.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    onAppear(<img src="1408388055479.png" />, <span class="skw">type</span>(<span class="str">'n'</span>))
    waitVanish(<img src="1408388055479.png" />)
    <span class="cmt">#----------------------------------------------------------------------#
</span>
    <span class="cmt">#Starting from Timeslips home screen
</span>    <span class="cmt">#Defect for Reprinting multiple bills to PDF can use the incorrect PDF names
</span>    <span class="cmt">#we have to first backup the smoketest DB and then restore a DB that has data we can use to test several defects and then once verified restore the original smoke test DB to move on.
</span>


    <span class="cmt">#('- backing up Current Smoke test DB')
</span>    Toolbox.Backup_DB(vBDBLocation)
    <span class="cmt">#('- Restoring PDF Reprint Bills Defect Backup')
</span>    Toolbox.Restore_DB(vRDBLocation)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">'b'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'r'</span>)
    <span class="skw">wait</span>(<img src="1408480754612.png" />, <span class="dig">30</span>)

    <span class="skw">type</span>(Key.TAB + Key.TAB)
    <span class="kw">if</span> <span class="kw">not</span> exists(Pattern(<img src="1408480780555.png" />).similar(<span class="dig">0.98</span>)):
        <span class="skw">click</span>(<img src="1408480840367.png" />)
    <span class="kw">if</span> (Env.isLockOn(Key.NUM_LOCK)):
        <span class="skw">type</span>(Key.NUM_LOCK)
    keyDown(Key.SHIFT)
    <span class="skw">type</span>(Key.DOWN + Key.DOWN + Key.DOWN)
    keyUp(Key.SHIFT)
    <span class="skw">type</span>(Key.F4)
    <span class="kw">assert</span> exists(<img src="1408482292865.png" />)
    <span class="skw">type</span>(Key.TAB + Key.TAB)
    <span class="skw">type</span>(<span class="str">'pdf'</span>)
    <span class="skw">type</span>(Key.TAB + Key.SPACE)
    <span class="skw">wait</span>(<img src="1408556853816.png" />, <span class="dig">30</span>)

    <span class="skw">click</span>(<img src="1408562174353.png" />)
    <span class="skw">type</span>(Key.TAB)

    paste(os.path.join(<span class="str">r'C:\Sikuli Scripts VM X local copy for testing'</span>, <span class="str">'2015'</span>, <span class="str">'Data'</span>, <span class="str">'PDF Reprint Bill Testing'</span>))
    <span class="skw">type</span>(Key.ENTER)
    <span class="kw">if</span> exists(<img src="1408557908502.png" />):
        <span class="skw">type</span>(<span class="str">'y'</span>, KeyModifier.ALT)
        waitVanish(<img src="1408557908502.png" />)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">'r'</span>, KeyModifier.WIN)
    <span class="skw">wait</span>(<img src="1408556695227.png" />, <span class="dig">30</span>)
    paste(os.path.join(<span class="str">r'C:\Sikuli Scripts VM X local copy for testing'</span>, <span class="str">'2015'</span>, <span class="str">'Data'</span>, <span class="str">'PDF Reprint Bill Testing'</span>))
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(Pattern(<img src="1408557839163.png" />).similar(<span class="dig">0.86</span>), <span class="dig">30</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(Pattern(<img src="1408558635209.png" />).similar(<span class="dig">0.97</span>)):
        <span class="skw">click</span>(Pattern(<img src="1408558674898.png" />).similar(<span class="dig">0.91</span>))
    <span class="kw">assert</span> exists(<img src="1408558705115.png" />)
    <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    waitVanish(Pattern(<img src="1408557839163.png" />).similar(<span class="dig">0.86</span>))
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408480754612.png" />)
    <span class="cmt">#----------------------------------------------------------------------#
</span>    <span class="cmt">#Defect for Reprint bills can not be sorted by custom field
</span>    <span class="skw">type</span>(<span class="str">'p'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">wait</span>(<img src="1408565429189.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'t'</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408565501614.png" />, <span class="dig">30</span>)
    paste(<span class="str">'SortingCustom'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408565501614.png" />)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">6</span>):
        TABFunction.tab(x)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408565429189.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<span class="dig">.5</span>)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1407956749298.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'abington'</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408567750831.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.F6 + Key.F6 + Key.F6)
    paste(<img src="1408567876709.png" />, <span class="str">'SortingCustom'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(<span class="str">'b'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'r'</span>)
    <span class="skw">wait</span>(<img src="1408646814298.png" />, <span class="dig">30</span>)
    <span class="kw">assert</span> exists(Pattern(<img src="1408647519293.png" />).similar(<span class="dig">0.93</span>))
    <span class="skw">type</span>(Key.TAB + Key.SPACE)
    <span class="skw">wait</span>(<img src="1408647448546.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">13</span>):
        <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB + Key.SPACE)
    <span class="skw">wait</span>(<img src="1408653192311.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'contains'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'SortingCustom'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408654653778.png" />)
    <span class="skw">type</span>(<span class="str">'o'</span>, KeyModifier.ALT)
    waitVanish(<img src="1408654702143.png" />)
    <span class="kw">assert</span> <span class="kw">not</span> exists(Pattern(<img src="1408654793898.png" />).similar(<span class="dig">0.96</span>))
    <span class="kw">assert</span> exists(Pattern(<img src="1408654766923.png" />).similar(<span class="dig">0.96</span>))
    <span class="skw">type</span>(Key.F4, KeyModifier.CTRL)
    waitVanish(<img src="1408654928512.png" />)
    <span class="cmt">#----------------------------------------------------------------------#
</span>    <span class="cmt"># Defect to test slip list not able to sort by custom field
</span>
    <span class="skw">type</span>(<span class="str">'m'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408729373371.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<img src="1408729400665.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">13</span>):
        <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB + Key.SPACE)
    <span class="skw">wait</span>(<img src="1408653192311.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'contains'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'SortingCustom'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408654653778.png" />)
    <span class="skw">type</span>(<span class="str">'o'</span>, KeyModifier.ALT)
    waitVanish(<img src="1408654702143.png" />)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408729532208.png" />)
    <span class="kw">assert</span> exists(Pattern(<img src="1408729571365.png" />).similar(<span class="dig">0.98</span>))

    <span class="cmt">#----------------------------------------------------------------------#
</span>
    <span class="cmt">#('- Restoring original smoke test Backup')
</span>    Toolbox.Restore_DB(vBDBLocation)

    <span class="cmt">#----------------------------------------------------------------------#
</span>    <span class="cmt">#Defect for Project defaults are not always copied from master client. 
</span>
    <span class="skw">type</span>(<span class="str">'p'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'g'</span>)
    <span class="skw">wait</span>(<img src="1408731124361.png" />, <span class="dig">30</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">6</span>):
        <span class="skw">type</span>(Key.F6)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.ALT)
    <span class="kw">if</span> <span class="kw">not</span> exists(<img src="1408739581714.png" />):
        <span class="skw">type</span>(Key.DECIMAL)
        <span class="kw">assert</span> exists(<img src="1408731695461.png" />)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408731743027.png" />)

    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408731785640.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'Sikuli Test Client 1'</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408736433557.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    paste(<span class="str">'.'</span>)
    <span class="skw">wait</span>(<img src="1408736497329.png" />, <span class="dig">30</span>)
    paste(<span class="str">'Project1'</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">assert</span> exists(<img src="1408736621529.png" />)
    <span class="skw">type</span>(Key.F4, KeyModifier.CTRL)
    onAppear(<img src="1408736698052.png" />, <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT))
    waitVanish(<img src="1408736750368.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408736937669.png" />, <span class="dig">30</span>)
    paste(<span class="str">'Sikuli Test Client.Project'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408736976034.png" />)
    paste(<span class="str">'THIS SHOULD APPEAR 1'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408737071628.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408738934509.png" />, <span class="dig">30</span>)
    paste(<span class="str">'.'</span>)
    onAppear(<img src="1408737135111.png" />, paste(<span class="str">'Project 2'</span>))
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408737168326.png" />)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">assert</span> exists(<img src="1408739867016.png" />)
    paste(<span class="str">'THIS SHOULD APPEAR 2'</span>)
    keyDown(Key.SHIFT)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">7</span>):
        TABFunction.tab(x)
    keyUp(Key.SHIFT)
    <span class="skw">type</span>(Key.SPACE)
    <span class="kw">assert</span> exists(<img src="1408738858408.png" />)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408738899391.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408738952227.png" />, <span class="dig">30</span>)
    paste(<span class="str">'.'</span>)
    <span class="skw">wait</span>(<img src="1408738988465.png" />, <span class="dig">30</span>)
    paste(<span class="str">'Project 3'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408739016479.png" />)
    <span class="kw">assert</span> exists(<img src="1408739912798.png" />)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408739200356.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="cmt">#----------------------------------------------------------------------#
</span>    <span class="cmt">#testing defect where no dates import from Template client or normal client
</span>    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408731785640.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.F6)
    <span class="skw">wait</span>(<img src="1408740755919.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408740789373.png" />, <span class="dig">30</span>)
    paste(<span class="str">'*Rate Template Test'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408740827153.png" />)
    <span class="skw">type</span>(Key.F6 + Key.F6)
    paste(<span class="str">'100'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'200'</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">19</span>):
        <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL + KeyModifier.SHIFT)
    <span class="skw">wait</span>(<img src="1408741077186.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'sikuli'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="kw">assert</span> exists(<img src="1408741190587.png" />)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408741219217.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL + KeyModifier.SHIFT)
    <span class="skw">wait</span>(<img src="1408741077186.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'slip'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB + <span class="str">'2'</span>)
    <span class="kw">assert</span> exists(<img src="1408741429924.png" />)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408741435235.png" />)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408741518086.png" />)
    <span class="kw">if</span> exists(<img src="1408741538669.png" />):
        <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
        waitVanish(<img src="1408741538669.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408741623688.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408731785640.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408741720457.png" />, <span class="dig">30</span>)
    paste(<span class="str">'Rate Import Test Client'</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408741790493.png" />)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408741518086.png" />)
    <span class="skw">type</span>(Key.F6 + Key.F6)
    <span class="skw">click</span>(Pattern(<img src="1408741854904.png" />).similar(<span class="dig">0.97</span>))
    <span class="skw">wait</span>(<img src="1408741911181.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.TAB, KeyModifier.SHIFT)
    <span class="skw">type</span>(<span class="str">'template'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'Rate Template'</span>)
    <span class="skw">type</span>(Key.TAB + Key.TAB + Key.ENTER)
    <span class="skw">wait</span>(<img src="1408742247663.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408742247663.png" />)
    <span class="kw">assert</span> exists(Pattern(<img src="1408978819700.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">assert</span> exists(Pattern(<img src="1408978838634.png" />).similar(<span class="dig">0.97</span>))
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408742382055.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'y'</span>, KeyModifier.ALT)
    waitVanish(<img src="1408742382055.png" />)
    <span class="kw">if</span> exists(<img src="1408741538669.png" />):
        <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
        waitVanish(<img src="1408741538669.png" />)

    <span class="cmt">#----------------------------------------------------------------------#
</span>
    <span class="cmt">#Defect for text search filtering not working
</span>    <span class="skw">type</span>(<span class="str">'m'</span>, KeyModifier.CTRL)
    <span class="cmt">#using assigned parameters at top of script. if values need to be changed change them up there.
</span>    Toolbox.Create_Time_Slip(pTK,pAct,pClient,pRef,pExtra,pDescription,pStartDate,pEndDate,pTimeEst,pTimeSpent,pRateValue)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(<span class="str">'c'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'x'</span>)
    <span class="skw">wait</span>(<img src="1408987482143.png" />, <span class="dig">30</span>)
    paste(pDescription)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<img src="1408987546930.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'g'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'m'</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'c'</span>)
    <span class="skw">type</span>(Key.TAB + Key.ENTER)
    <span class="skw">wait</span>(<img src="1408987674354.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'pClient'</span>)
    <span class="skw">type</span>(Key.F4)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408987674354.png" />)
    <span class="skw">type</span>(<span class="str">'o'</span>, KeyModifier.ALT)
    waitVanish(<img src="1408987674354.png" />)
    <span class="skw">type</span>(<span class="str">'e'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">assert</span> exists(<img src="1408989593975.png" />)
    <span class="skw">type</span>(<span class="str">'c'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    <span class="cmt">#----------------------------------------------------------------------#
</span>    <span class="cmt">#Deferct to test Email receipt to multiple CC address when separated using carriage returns causes AV2
</span>    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    Toolbox.create_test_client(<span class="str">'EmailReceiptTest'</span>)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408731785640.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408736433557.png" />, <span class="dig">30</span>)
    keyDown(Key.SHIFT)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">6</span>):
        <span class="skw">type</span>(Key.TAB)
    keyUp(Key.SHIFT)
    paste(<span class="str">'Receipt@example.com'</span>)
    <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'Receipt1@example.com'</span>)
    <span class="skw">type</span>(Key.ENTER)
    paste(<span class="str">'Receipt2@example.com'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408741518086.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)
    <span class="skw">type</span>(<span class="str">'t'</span>, KeyModifier.CTRL)
    <span class="kw">if</span> exists(<img src="1408998619403.png" />):
        <span class="skw">type</span>(Key.TAB + Key.TAB)
        <span class="skw">type</span>(<span class="str">'c'</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
        <span class="skw">type</span>(Key.ENTER)
    <span class="kw">elif</span> exists(<img src="1408998757258.png" />):
        <span class="skw">type</span>(Key.TAB + Key.TAB)
        <span class="skw">type</span>(<span class="str">'c'</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
        <span class="skw">type</span>(Key.ENTER)
    <span class="kw">elif</span> exists(<img src="1408998951149.png" />):
        <span class="skw">type</span>(Key.TAB + Key.TAB + Key.TAB)
        <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
        <span class="skw">type</span>(Key.ENTER)

    <span class="skw">wait</span>(<img src="1408993277258.png" />, <span class="dig">30</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">3</span>):
        <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
    <span class="skw">wait</span>(<img src="1408993461295.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish(<img src="1408993461295.png" />)
    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408994170377.png" />, <span class="dig">30</span>)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">6</span>):
        <span class="skw">type</span>(Key.TAB)
    paste(<span class="str">'150'</span>)
    <span class="skw">type</span>(<span class="str">'s'</span>, KeyModifier.CTRL)
    waitVanish(<img src="1408741518086.png" />)
    <span class="skw">type</span>(<span class="str">'e'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408994299632.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'e'</span>, KeyModifier.ALT)
    <span class="skw">wait</span>(<img src="1408994841974.png" />, <span class="dig">30</span>)
    <span class="kw">assert</span> exists(Pattern(<img src="1408994913569.png" />).similar(<span class="dig">0.98</span>))
    <span class="skw">type</span>(Key.ESC)
    waitVanish(<img src="1408994841974.png" />)
    <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    waitVanish(Pattern(<img src="1408994299632.png" />).similar(<span class="dig">0.95</span>))
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)

    <span class="cmt">#----------------------------------------------------------------------#
</span>
    <span class="cmt">#defect to check if the insert data token option is availalable in the right click pop up menu
</span>    <span class="skw">type</span>(<span class="str">'n'</span>, KeyModifier.ALT)
    <span class="skw">type</span>(<span class="str">'i'</span>)
    <span class="skw">wait</span>(<img src="1408731785640.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(<span class="str">'EmailReceiptTest'</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<img src="1408736433557.png" />, <span class="dig">30</span>)

    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">8</span>):
        <span class="skw">type</span>(Key.F6)
    <span class="kw">for</span> x <span class="kw">in</span> range(<span class="dig">0</span>, <span class="dig">5</span>):
        <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(<span class="str">'o'</span>, KeyModifier.CTRL)
    <span class="skw">wait</span>(<img src="1408996532697.png" />,<span class="dig">30</span>)
    <span class="skw">rightClick</span>(<img src="1408996596301.png" />)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">assert</span> exists(Pattern(<img src="1408996640355.png" />).similar(<span class="dig">0.97</span>))
    <span class="skw">click</span>(Pattern(<img src="1408996640355.png" />).similar(<span class="dig">0.97</span>))
    <span class="skw">wait</span>(<img src="1408996688815.png" />, <span class="dig">30</span>)
    <span class="skw">type</span>(Key.ESC)
    waitVanish(<img src="1408996688815.png" />)
    <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    waitVanish(<img src="1408996532697.png" />)
    <span class="skw">type</span>(<span class="str">'w'</span>, KeyModifier.CTRL)










SR1_2015_defect_fixes()
</pre>
</body>
</html>
